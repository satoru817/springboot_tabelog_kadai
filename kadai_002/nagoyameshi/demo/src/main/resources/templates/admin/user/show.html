<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
<head>
    <div th:replace="~{fragment::headResources}"></div>
    <script th:src="@{/js/long_id_toggle.js}" defer></script>
    <title>ユーザー詳細</title>
</head>
<body class="d-flex flex-column min-vh-100">
<div class="wrapper">
    <!-- ヘッダー -->
    <div th:replace="~{fragment::header}"></div>

    <main>
        <div class="container pt-4 pb-5">
            <div class="row justify-content-center">
                <h2 th:text="${user.name}+'さんの詳細情報一覧'" class="text-center mb-3"></h2>
                <div th:if="${user.role.name != 'ROLE_ADMIN' }" class="col-lg-5">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">サブスクリプション一覧</h5>
                            <ul class="list-group">
                                <li th:each="sbsc , iterStat : ${user.subscriptions}"
                                    class="list-group-item list-group-item-action" th:classappend="${iterStat.last}? '' : 'border-bottom'">
                                    <small>
                                        <span class="long_id text-primary user-select-all"
                                              th:data-full-id="${sbsc.stripeSubscriptionId}"
                                              th:text="${#strings.substring(sbsc.stripeSubscriptionId,0,8)}+'...'"></span>
                                    </small>
                                    <span class="ms-2"
                                          th:text="${#temporals.format(sbsc.startDate,'yyyy/MM/dd')}"></span>
                                    <span>~</span>
                                    <span th:if="${sbsc.endDate!=null}"
                                          th:text="${#temporals.format(sbsc.endDate,'yyyy/MM/dd')}"></span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="card mt-3">
                        <div class="card-body ">
                            <h5 class="card-title">登録カード一覧</h5>
                            <ul class="list-group">
                                <li th:each="card ,  iterStat : ${user.cards}"
                                    class="list-group-item list-group-item-action" th:classappend="${iterStat.last}? '':'border-bottom'">
                                    <small>
                                        <span class="long_id text-primary user-select-all"
                                              th:data-full-id="${card.stripeCardId}"
                                              th:text="${#strings.substring(card.stripeCardId,0,8)}+'...'"></span>
                                    </small>
                                    <span class="ms-2" th:text="${card.brand}"></span>
                                    <span class="ms-2" th:text="${card.last4}"></span>
                                    <span class="ms-2" th:text="${card.expMonth}+'/'+${card.expYear}"></span>
                                    <span class="ms-2" th:text="${card.isDefault} ? '利用中': '不使用'"></span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="card mt-3">
                        <div class="card-body">
                            <h5 class="card-title">その他の情報</h5>
                            <ul class="list-group">
                                <a th:href="@{/admin/reservation/show/__${user.userId}__}" class="list-group-item list-group-item-action">
                                    予約一覧
                                    <i class="bi bi-chevron-right opacity-0 transition_opacity"></i>
                                </a>
                                <a class="list-group-item list-group-item-action">
                                    レビュー一覧
                                    <i class="bi bi-chevron-right opacity-0 transition_opacity"></i>
                                </a>
                                <a class="list-group-item list-group-item-action">
                                    お気に入り一覧
                                    <i class="bi bi-chevron-right opacity-0 transition_opacity"></i>
                                </a>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-lg-5">
                    <div class="card">
                        <div class="card-body user_info">
                            <h5 class="card-title">基本情報</h5>
                            <p class="card-text">
                            <div class="row pb-2 mb-2 border-bottom">
                                <div class="col-4">
                                    <span class="fw-bold">ID</span>
                                </div>

                                <div class="col">
                                    <span th:text="${user.userId}"></span>
                                </div>
                            </div>
                            <div class="row pb-2 mb-2 border-bottom">
                                <div class="col-4">
                                    <span class="fw-bold">ロール</span>
                                </div>
                                <div class="col">
                                    <div th:replace="~{fragment::role_display}"></div>
                                </div>
                            </div>

                            <div class="row pb-2 mb-2 border-bottom">
                                <div class="col-4">
                                    <span class="fw-bold">ユーザー名</span>
                                </div>

                                <div class="col">
                                    <span th:text="${user.name}"></span>
                                </div>
                            </div>

                            <div class="row pb-2 mb-2 border-bottom">
                                <div class="col-4">
                                    <span class="fw-bold">予約者名</span>
                                </div>

                                <div class="col">
                                    <span th:text="${user.nameForReservation}"></span>
                                </div>
                            </div>

                            <div class="row pb-2 mb-2 border-bottom">
                                <div class="col-4">
                                    <span class="fw-bold">郵便番号</span>
                                </div>

                                <div class="col">
                                    <span th:text="${user.postalCode}"></span>
                                </div>
                            </div>

                            <div class="row pb-2 mb-2 border-bottom">
                                <div class="col-4">
                                    <span class="fw-bold">住所</span>
                                </div>

                                <div class="col">
                                    <span th:text="${user.address}"></span>
                                </div>
                            </div>

                            <div class="row pb-2 mb-2 border-bottom">
                                <div class="col-4">
                                    <span class="fw-bold">電話番号</span>
                                </div>

                                <div class="col">
                                    <span th:text="${user.phoneNumber}"></span>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-4">
                                    <span class="fw-bold">メールアドレス</span>
                                </div>

                                <div class="col">
                                    <span th:text="${user.email}"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3">

                </div>
            </div>
        </div>
    </main>


</div>
<!-- フッター -->
<script>
    const userInfo = document.querySelector('.user_info');
    const spans = userInfo.querySelectorAll('span');
    spans.forEach(span=>{
        span.classList.add('user-select-all');
    });
</script>
<div th:replace="~{fragment::footer}"></div>


</body>
</html>